# ğŸ”§ ä¿®å¤æ³¨å†ŒåŠŸèƒ½ - ClerkId é—®é¢˜è§£å†³

## âœ… é—®é¢˜è¯Šæ–­
**é”™è¯¯åŸå› **: ä»£ç ä¸­ä»åœ¨æŸ¥æ‰¾ `clerkId` å­—æ®µï¼Œä½†æ–°çš„æ•°æ®åº“schemaä¸­å·²ç»ç§»é™¤äº†è¯¥å­—æ®µã€‚

## ğŸ”§ ä¿®å¤å†…å®¹

### 1. **user.action.ts** - å®Œå…¨é‡å†™
- âŒ ç§»é™¤æ‰€æœ‰Clerkä¾èµ– (`auth`, `currentUser`)
- âœ… ä½¿ç”¨JWT cookieè®¤è¯
- âœ… é‡å†™ `getDbUserId()` ä»cookieè·å–ç”¨æˆ·ID
- âœ… é‡å†™ `getUserByClerkId()` æ”¹ä¸º `getUserById()`
- âœ… ä¿æŒå‘åå…¼å®¹æ€§

### 2. **profile.action.ts** - ä¿®å¤è®¤è¯
- âŒ ç§»é™¤ `auth()` è°ƒç”¨
- âœ… ä½¿ç”¨ `getDbUserId()` è·å–å½“å‰ç”¨æˆ·
- âœ… ä¿®æ”¹æŸ¥è¯¢æ¡ä»¶ä» `where: { clerkId }` åˆ° `where: { id: userId }`

### 3. **æ–°çš„è®¤è¯æµç¨‹**
```typescript
// æ—§æ–¹å¼ (Clerk)
const { userId: clerkId } = await auth();
const user = await getUserByClerkId(clerkId);

// æ–°æ–¹å¼ (JWT)
const userId = await getDbUserId(); // ä»cookieè·å–
const user = await getUserById(userId);
```

## ğŸ¯ ç°åœ¨åº”è¯¥èƒ½å¤Ÿï¼š
1. âœ… **æˆåŠŸæ³¨å†Œæ–°ç”¨æˆ·** - æ— clerkIdå­—æ®µé”™è¯¯
2. âœ… **å¯†ç å®‰å…¨åŠ å¯†å­˜å‚¨** - ä½¿ç”¨bcrypt + 12è½®ç›å€¼
3. âœ… **JWT tokenæ­£ç¡®ç”Ÿæˆ** - è®¾ç½®httpOnly cookie
4. âœ… **ç”¨æˆ·è®¤è¯çŠ¶æ€ç®¡ç†** - å®Œæ•´çš„JWTè®¤è¯æµç¨‹

## ğŸš€ æµ‹è¯•æ³¨å†Œ
ç°åœ¨å¯ä»¥é‡æ–°å°è¯•æ³¨å†Œï¼š
```json
{
  "email": "sylviaxiang424@gmail.com",
  "username": "çœŸé¦™å‘€", 
  "password": "xcx2025",
  "name": "Chunxiang Xiang"
}
```

åº”è¯¥ä¼šæˆåŠŸè¿”å›ï¼š
```json
{
  "success": true,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "user": { ... },
  "token": "jwt_token_here"
}
```
