# ğŸ“‹ ç¯å¢ƒå˜é‡é…ç½®æŒ‡å—

## ğŸ”’ ä¸ºä»€ä¹ˆ .env æ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ° GitHubï¼Ÿ

ç¯å¢ƒå˜é‡æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼š
- æ•°æ®åº“å¯†ç 
- API å¯†é’¥ï¼ˆå¦‚ UploadThing Secretï¼‰
- JWT å¯†é’¥
- ç¬¬ä¸‰æ–¹æœåŠ¡å‡­è¯

ä¸Šä¼ åˆ°å…¬å¼€ä»“åº“ä¼šé€ æˆ**ä¸¥é‡å®‰å…¨é£é™©**ï¼

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### âœ… æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨æ¨¡æ¿æ–‡ä»¶ï¼ˆæ¨èï¼‰

#### 1. åˆ›å»ºæ¨¡æ¿æ–‡ä»¶
åœ¨é¡¹ç›®ä¸­åˆ›å»º `.env.example` æˆ– `.env.template`ï¼š

```bash
# .env.example - å¯ä»¥å®‰å…¨ä¸Šä¼ åˆ° GitHub
NODE_ENV=production
PORT=3000
NEXT_PUBLIC_APP_URL=https://yourdomain.com
NEXTAUTH_URL=https://yourdomain.com
NEXTAUTH_SECRET=your-32-character-secret-here
DATABASE_URL=postgresql://username:password@localhost:5432/database
UPLOADTHING_SECRET=sk_live_your_secret_here
UPLOADTHING_APP_ID=your_app_id_here
```

#### 2. éƒ¨ç½²æ—¶å¤åˆ¶å¹¶é…ç½®
```bash
# åœ¨æœåŠ¡å™¨æ‰§è¡Œ
cp .env.example .env.production
vim .env.production  # å¡«å…¥çœŸå®å€¼
```

### âœ… æ–¹æ¡ˆäºŒï¼šéƒ¨ç½²è„šæœ¬è‡ªåŠ¨ç”Ÿæˆ

æˆ‘ä»¬çš„éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆ `.env.production` æ–‡ä»¶ï¼Œè¯¢é—®æ‚¨è¾“å…¥çœŸå®é…ç½®ã€‚

### âœ… æ–¹æ¡ˆä¸‰ï¼šå®‰å…¨å­˜å‚¨æœåŠ¡

#### GitHub Secretsï¼ˆCI/CD éƒ¨ç½²ï¼‰
```yaml
# .github/workflows/deploy.yml
env:
  NEXTAUTH_SECRET: ${{ secrets.NEXTAUTH_SECRET }}
  DATABASE_URL: ${{ secrets.DATABASE_URL }}
  UPLOADTHING_SECRET: ${{ secrets.UPLOADTHING_SECRET }}
```

#### é˜¿é‡Œäº‘å¯†é’¥ç®¡ç†æœåŠ¡
- ä½¿ç”¨é˜¿é‡Œäº‘ KMS å­˜å‚¨æ•æ„Ÿé…ç½®
- è¿è¡Œæ—¶åŠ¨æ€è·å–

## ğŸš€ æ¨èçš„éƒ¨ç½²æµç¨‹

### æ­¥éª¤1ï¼šæœ¬åœ°å¼€å‘
```bash
# æœ¬åœ°ä½¿ç”¨ .env.localï¼ˆä¸ä¸Šä¼ ï¼‰
cp .env.example .env.local
# å¡«å…¥å¼€å‘ç¯å¢ƒé…ç½®
```

### æ­¥éª¤2ï¼šç‰ˆæœ¬æ§åˆ¶
```bash
# ç¡®ä¿ .gitignore åŒ…å«
echo ".env*" >> .gitignore
echo "!.env.example" >> .gitignore

# åªä¸Šä¼ æ¨¡æ¿æ–‡ä»¶
git add .env.example
git commit -m "add env template"
```

### æ­¥éª¤3ï¼šæœåŠ¡å™¨éƒ¨ç½²
```bash
# æ–¹æ³•Aï¼šæ‰‹åŠ¨é…ç½®
cp .env.example .env.production
vim .env.production

# æ–¹æ³•Bï¼šä½¿ç”¨æˆ‘ä»¬çš„ä¸€é”®è„šæœ¬ï¼ˆä¼šè¯¢é—®å¹¶ç”Ÿæˆï¼‰
./deploy/quick-deploy.sh
```

## ğŸ”‘ é‡è¦é…ç½®é¡¹è¯´æ˜

### NEXTAUTH_SECRET
```bash
# ç”Ÿæˆ 32 ä½éšæœºå¯†é’¥
openssl rand -base64 32
# æˆ–åœ¨çº¿ç”Ÿæˆï¼šhttps://generate-secret.vercel.app/32
```

### DATABASE_URL
```bash
# æ ¼å¼
postgresql://ç”¨æˆ·å:å¯†ç @ä¸»æœº:ç«¯å£/æ•°æ®åº“å?schema=public

# ç¤ºä¾‹
postgresql://social_user:your_password@localhost:5432/social_prod?schema=public
```

### UploadThing é…ç½®
1. è®¿é—® https://uploadthing.com/dashboard
2. åˆ›å»ºåº”ç”¨è·å– Secret å’Œ App ID
3. å¤åˆ¶åˆ°ç¯å¢ƒå˜é‡ä¸­

## ğŸ“ .gitignore é…ç½®

ç¡®ä¿æ‚¨çš„ `.gitignore` åŒ…å«ï¼š

```gitignore
# ç¯å¢ƒå˜é‡æ–‡ä»¶
.env
.env.local
.env.development
.env.production
.env.test

# ä½†å…è®¸æ¨¡æ¿æ–‡ä»¶
!.env.example
!.env.template

# å…¶ä»–æ•æ„Ÿæ–‡ä»¶
*.log
.DS_Store
node_modules/
.next/
dist/
```

## ğŸš¨ å®‰å…¨æœ€ä½³å®è·µ

### âœ… åº”è¯¥åšçš„
- ä½¿ç”¨å¼ºå¯†ç å’Œéšæœºå¯†é’¥
- å®šæœŸè½®æ¢æ•æ„Ÿå‡­è¯
- ä½¿ç”¨ç¯å¢ƒå˜é‡è€Œéç¡¬ç¼–ç 
- é™åˆ¶æ•°æ®åº“ç”¨æˆ·æƒé™
- å¯ç”¨é˜²ç«å¢™å’Œ SSL

### âŒ ä¸åº”è¯¥åšçš„
- å°† .env æ–‡ä»¶ä¸Šä¼ åˆ°ç‰ˆæœ¬æ§åˆ¶
- åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
- ä½¿ç”¨å¼±å¯†ç 
- å…±äº«ç”Ÿäº§ç¯å¢ƒå‡­è¯
- åœ¨æ—¥å¿—ä¸­æ‰“å°æ•æ„Ÿä¿¡æ¯

## ğŸ›¡ï¸ æ³„éœ²åçš„åº”å¯¹æªæ–½

å¦‚æœä¸å°å¿ƒä¸Šä¼ äº† .env æ–‡ä»¶ï¼š

1. **ç«‹å³æ’¤é”€å‡­è¯**ï¼š
   - é‡ç½®æ•°æ®åº“å¯†ç 
   - é‡æ–°ç”Ÿæˆ API å¯†é’¥
   - æ›´æ¢ JWT å¯†é’¥

2. **æ¸…ç† Git å†å²**ï¼š
   ```bash
   # ä»å†å²è®°å½•ä¸­å®Œå…¨åˆ é™¤
   git filter-branch --force --index-filter \
   'git rm --cached --ignore-unmatch .env' \
   --prune-empty --tag-name-filter cat -- --all

   # å¼ºåˆ¶æ¨é€
   git push origin --force --all
   ```

3. **æ›´æ–°éƒ¨ç½²**ï¼š
   - ä½¿ç”¨æ–°çš„ç¯å¢ƒå˜é‡é‡æ–°éƒ¨ç½²
   - é€šçŸ¥ç›¸å…³äººå‘˜å®‰å…¨äº‹ä»¶
